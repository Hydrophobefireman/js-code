{"version":3,"file":"j-utils.modern.js","sources":["../src/modules/util.ts","../src/modules/warnings.ts","../src/modules/base64ToArrayBuffer/index.ts","../src/modules/nextEvent/index.ts","../src/modules/arrayBufferToBase64/index.ts","../src/modules/retry/index.ts","../src/modules/Object/keys.ts","../src/modules/urlencode/index.ts","../src/modules/Object/assign.ts","../src/modules/Element/append.ts","../src/modules/loadCSS/index.ts","../src/modules/es6/loose/constants.ts","../src/modules/es6/loose/Map/_Symbol.ts","../src/modules/es6/loose/Map/proto.ts","../src/shared.ts","../src/modules/es6/loose/Map/index.ts","../src/modules/es6/loose/Set/_Symbol.ts","../src/modules/es6/loose/Set/index.ts","../src/modules/es6/loose/Set/proto.ts","../src/modules/es6/loose/Weak-shared.ts","../src/modules/es6/loose/WeakMap/index.ts","../src/modules/es6/loose/WeakSet/index.ts","../src/modules/Object/entries.ts","../src/modules/Object/values.ts","../src/modules/Object/fromEntries.ts","../src/modules/Object/is.ts","../src/modules/Element/after.ts","../src/modules/Element/prepend.ts","../src/modules/Pipes/index.ts","../src/modules/cache/index.ts","../src/modules/debounce/index.ts"],"sourcesContent":["declare var ___this: { globalThis: Window };\nexport function patchGlobalThis(): typeof globalThis {\n  /** no idea how to write this function in sane typescript */\n  if (typeof globalThis === \"object\") return globalThis;\n  Object.defineProperty(Object.prototype, \"___this\", {\n    get: function () {\n      return this;\n    },\n    configurable: true,\n  });\n  ___this.globalThis = (___this as any) as Window;\n  const r: typeof globalThis = ___this as any;\n  delete (Object.prototype as any).___this;\n  return r;\n}\nconst global = patchGlobalThis();\n\nexport const _Sym = global.Symbol || {};\n\nexport const has = (a: string | number | symbol, b: object) => a in b;\n\nexport const emptyObj = {};\nexport const emptyArr = [];\n\nexport const isIterable = (k: any) => k && !!k[_Sym.iterator];\n\nexport const _Object: ObjectConstructor = emptyObj.constructor as ObjectConstructor;\n\nexport const hasOwnProp = emptyObj.hasOwnProperty;\n\nexport function _generateDocFrag(\n  args: (Node | (string | number | boolean | symbol))[]\n) {\n  const frag = document.createDocumentFragment();\n  args.forEach((arg) =>\n    frag.appendChild(\n      arg instanceof Node ? arg : document.createTextNode(String(arg))\n    )\n  );\n  return frag;\n}\n\nexport const domContext =\n  typeof window !== \"undefined\" &&\n  ((window.navigator && !!window.navigator.userAgent) ||\n    (window.document && !!document.createElement));\n\nexport const workerContext =\n  typeof self !== \"undefined\" &&\n  !!self.postMessage &&\n  typeof ((global as any) as { importScripts: (src: string) => any })\n    .importScripts === \"function\";\nexport const isBrowser = domContext || workerContext;\n","import { isBrowser } from \"./util\";\n// import { isBrowser } from \"./util.js\";\nexport const browserOnlyWarning = {\n  warn(msg?: string) {\n    if (!isBrowser) {\n      return console.warn(\n        msg || \"Some functionality may only work in a browser. Expect errors\"\n      );\n    }\n  },\n  _throw(msg?: string) {\n    if (!isBrowser)\n      throw new Error(\n        msg || \"A web browser is required for this module to run!\"\n      );\n  }\n};\n","import { browserOnlyWarning } from \"../warnings.js\";\n/**\n * base64 string to Array Buffer using Fetch API\n *\n * Only works in Browser environment\n *\n * @param b64 {string} string to get as ArrayBuffer\n */\nexport default function base64ToArrayBuffer(b64: string): Promise<ArrayBuffer> {\n  browserOnlyWarning._throw();\n  const data = fetch(\"data:,\" + b64);\n  return data.then(x => x.arrayBuffer());\n}\n","export default function nextEvent(\n  obj: EventTarget,\n  event: string\n): Promise<any> {\n  return new Promise(res => obj.addEventListener(event, res, { once: true }));\n}\n","import { browserOnlyWarning } from \"../warnings.js\";\n/**\n * ArrayBuffer to base64 implementation using FileReader API\n *\n * Naturally, Only works in browser environment\n *\n * @param buffer {ArrayBuffer} ArrayBuffer to convert into base64\n * @returns {string} base64 encoded string\n */\nexport default function arrayBufferToBase64(\n  buffer: ArrayBuffer\n): Promise<string> {\n  browserOnlyWarning._throw();\n  return new Promise((resolve, _) => {\n    const blob = new Blob([buffer], {\n      type: \"application/octet-binary\"\n    });\n    const reader = new FileReader();\n    reader.onload = evt => {\n      reader.onload = null;\n      if (evt == null || evt.target == null) return null;\n      const dataurl = evt.target.result as string;\n      resolve(dataurl.substr(dataurl.indexOf(\",\") + 1));\n    };\n    reader.readAsDataURL(blob);\n  });\n}\n","function wait(m: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, m));\n}\nexport default function retry<T>(\n  fn: (...a: any[]) => T,\n  max: number = 3,\n  waitInMS?: number,\n  bind?: any\n): () => Promise<T> {\n  return async function() {\n    let tries = 0;\n    while (tries < max) {\n      try {\n        return await Promise.resolve(fn.apply(bind, [].slice.call(arguments)));\n      } catch (e) {\n        tries++;\n        if (waitInMS) await wait(waitInMS);\n      }\n    }\n    throw new Error(\n      \"function \" + (fn.name || \"\") + \" failed \" + max + \" times\"\n    );\n  };\n}\n","import { hasOwnProp, _Object } from \"../util.js\";\nexport default \"keys\" in _Object\n  ? _Object.keys\n  : (function Object_keys(a: object): string[] {\n      const arr = [];\n      for (const i in a) hasOwnProp.call(a, i) && arr.push(i);\n      return arr;\n    } as ObjectConstructor[\"keys\"]);\n","import { patchGlobalThis } from \"../util.js\";\nimport keys from \"../Object/keys.js\";\npatchGlobalThis();\nexport default function urlencode(a: { [k: string]: string }): string {\n  if (globalThis.URLSearchParams) {\n    return new URLSearchParams(a).toString();\n  } else {\n    return (\n      \"\" +\n      keys(a)\n        .map(function(b) {\n          return encodeURIComponent(b) + \"=\" + encodeURIComponent(a[b]);\n        })\n        .join(\"&\")\n    );\n  }\n}\n","import { _Object, hasOwnProp } from \"../util.js\";\nexport default \"assign\" in _Object\n  ? _Object.assign\n  : (function Object_assign(target: import(\"./ot\").default) {\n      for (let i = 1; i < arguments.length; i++) {\n        const source = arguments[i];\n        for (const key in source) {\n          if (hasOwnProp.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n      return target;\n    } as ObjectConstructor[\"assign\"]);\n","import { browserOnlyWarning } from \"../warnings.js\";\nimport { _generateDocFrag, emptyArr, has } from \"../util.js\";\nexport default function Element_append(element: Element) {\n  browserOnlyWarning._throw();\n  if (!element) throw new Error(\"cannot append elements\");\n  const args = emptyArr.slice.call(arguments, 1);\n  if (has(\"append\", element)) {\n    element.append.apply(element, args);\n  }\n  const frag = _generateDocFrag(args);\n  element.appendChild(frag);\n}\n","import { browserOnlyWarning } from \"../warnings.js\";\nimport assign from \"../Object/assign.js\";\nimport append from \"../Element/append.js\";\nexport default function loadCSS(url: string): Promise<void> {\n  browserOnlyWarning._throw();\n  const link: HTMLLinkElement = assign(document.createElement(\"link\"), {\n    rel: \"stylesheet\",\n    href: url\n  });\n  return new Promise((res, rej) => {\n    const opt = { once: true };\n    link.addEventListener(\"load\", () => res(), opt);\n    link.addEventListener(\"error\", () => rej(), opt);\n    (append as any)(document.head, link);\n  });\n}\n","import { patchGlobalThis as patch, has } from \"../../util.js\";\nlet _global = patch();\nexport const HAS_MAP = has(\"Map\", _global);\nexport const HAS_SET = has(\"Set\", _global);\nexport const HAS_WEAK = has(\"WeakMap\", _global) && has(\"WeakSet\", _global);\nexport const m = \"__@@map\";\nexport const s = \"__@@set\";\nconst _isNaN = (k: any) => k !== k;\nexport const _EqCheck = (x: any, y: any) => x === y || (_isNaN(x) && _isNaN(y));\nexport const normalizeNegativeZero = (k: any) => (k === 0 ? 0 : k);\nexport const _mapKey = \"__@@mkey\";\nexport const _mapVal = \"__@mVal\";\n","import { m } from \"../constants.js\";\nlet entries: () => IterableIterator<[any, any]>;\nlet values: () => IterableIterator<any>;\nlet keys: () => IterableIterator<any>;\ntype FakeMap = import(\"./index\").default<any, any>;\nif (typeof Symbol !== \"undefined\") {\n  function mapEntriesIterator(map: FakeMap): IterableIterator<[any, any]> {\n    const _ = map[m];\n    return _[Symbol.iterator]();\n  }\n  entries = function entries(this: FakeMap) {\n    return mapEntriesIterator(this);\n  };\n  function mapKeyValIterator(map: FakeMap, isKey: boolean) {\n    const _ = map[m];\n    let i = 0;\n    const len = _.length;\n    const kv = isKey ? 0 : 1;\n    const obj: IterableIterator<[any, any]> = {\n      [Symbol.iterator]: function() {\n        return this;\n      },\n      next: function() {\n        if (i < len) {\n          return { value: _[i++][kv], done: false };\n        }\n        return { value: void 0, done: true };\n      }\n    };\n    return obj;\n  }\n  values = function values(this: FakeMap) {\n    return mapKeyValIterator(this, false);\n  };\n  keys = function keys(this: FakeMap) {\n    return mapKeyValIterator(this, true);\n  };\n} else {\n  entries = keys = values = function() {\n    console.warn(\"no symbol support\");\n  } as never;\n}\nexport default { keys, values, entries };\n","import { m, _EqCheck as is, normalizeNegativeZero } from \"../constants.js\";\nimport symbolProps from \"./_Symbol.js\";\nimport assign from \"../../../Object/assign.js\";\nfunction __i_getMapArr(that: import(\"./index\").default<any, any>, k: any) {\n  const arr = that[m];\n  const len = arr.length;\n  for (let i = 0; i < len; i++) {\n    const x = arr[i];\n    if (is(x[0], k)) return x;\n  }\n  return null;\n}\nexport default function setPrototypeProps(\n  FakeMap: import(\"./index\").FakeMapConstructor\n) {\n  FakeMap.prototype.set = function set(k, v) {\n    const prevArr = __i_getMapArr(this, k);\n    if (prevArr) {\n      prevArr[1] = v;\n    } else {\n      this[m].push([normalizeNegativeZero(k), v]);\n    }\n    return this;\n  };\n  FakeMap.prototype.has = function has(key) {\n    return !!__i_getMapArr(this, key);\n  };\n  FakeMap.prototype.delete = function del(k) {\n    let had: boolean = false;\n    this[m] = this[m].filter(x => {\n      const c = !is(x[0], k);\n      if (!c) had = true;\n      return c;\n    });\n    return had;\n  };\n  FakeMap.prototype.get = function get(key) {\n    const arr = __i_getMapArr(this, key);\n    return arr ? arr[1] : undefined;\n  };\n  FakeMap.prototype.forEach = function forEach(cb, that) {\n    const arr = this[m];\n    const len = arr.length;\n    for (let i = 0; i < len; i++) {\n      const val = arr[i];\n      const a = val[1],\n        b = val[0],\n        c = this;\n      that ? cb.call(that, a, b, c) : cb(a, b, c);\n    }\n  };\n\n  FakeMap.prototype.clear = function clear() {\n    return void (this[m].length = 0);\n  };\n  Object.defineProperty(FakeMap.prototype, \"size\", {\n    enumerable: false,\n    configurable: true,\n    get: function(this: import(\"./index\").default<any, any>) {\n      return this[m].length;\n    }\n  });\n  if (typeof Symbol !== \"undefined\") {\n    FakeMap.prototype[Symbol.iterator] = symbolProps.entries;\n    FakeMap.prototype[Symbol.toStringTag] = \"Map\";\n  }\n  assign(FakeMap.prototype, symbolProps);\n}\n","function _instanceof(left: any, right: Function) {\n  if (\n    right != null &&\n    typeof Symbol !== \"undefined\" &&\n    right[Symbol.hasInstance]\n  ) {\n    return !!right[Symbol.hasInstance](left);\n  } else {\n    return left instanceof right;\n  }\n}\n\nexport function _classCallCheck(instance: any, Constructor: Function) {\n  if (!_instanceof(instance, Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n","import { HAS_MAP, m } from \"../constants.js\";\nimport setup from \"./proto.js\";\nimport { isIterable } from \"../../../util.js\";\nimport { _classCallCheck } from \"../../../../shared.js\";\nfunction generateMap(fm: FakeMap<any, any>, it: Iterable<any> | undefined) {\n  if (it == null) return;\n  if (!isIterable(it))\n    throw new Error(\"value:\" + String(it) + \" is not iterable\");\n  const len = (it as Array<any>).length;\n  for (let i = 0; i < len; i++) {\n    const k = (it as Array<any>)[i];\n    if (!k || k.length !== 2) throw new Error(\"invalid arg\");\n    fm.set(k[0], k[1]);\n  }\n}\ninterface FakeMap<K, V> {\n  clear(): void;\n  delete(key: K): boolean;\n  forEach(\n    callbackfn: (value: V, key: K, map: FakeMap<K, V>) => void,\n    thisArg?: any\n  ): void;\n  get(key: K): V | undefined;\n  has(key: K): boolean;\n  set(key: K, value: V): this;\n  readonly size: number;\n  [m]: Array<[K, V]>;\n  [Symbol.toStringTag]: string;\n  [Symbol.iterator](): IterableIterator<[K, V]>;\n  values(): IterableIterator<V>;\n  keys(): IterableIterator<K>;\n  entries(): IterableIterator<[K, V]>;\n}\n\nexport interface FakeMapConstructor {\n  new (): FakeMap<any, any>;\n  new <K, V>(entries?: ReadonlyArray<readonly [K, V]> | null): FakeMap<K, V>;\n  readonly prototype: FakeMap<any, any>;\n  [Symbol.species]: FakeMapConstructor;\n}\n\n/**\n * Map implementation\n *\n * This Implementation uses One single array to store keys and values in their own arrays\n * Key index - 0\n * Value index - 1\n *\n * we could have used 2 separate Arrays for storing keys and values in matching indices\n * @TODO do a benchmark\n */\nconst FakeMap = (function FakeMap<K, V>(\n  this: FakeMap<K, V>,\n  iterable?: Iterable<[K, V]>,\n  forceUseCustomImplementation?: boolean\n): FakeMap<K, V> | Map<K, V> {\n  _classCallCheck(this, FakeMap);\n  if (!forceUseCustomImplementation && HAS_MAP)\n    return new Map(iterable as Iterable<[K, V]>);\n  this[m] = [];\n  generateMap(this, iterable);\n  return this;\n} as any) as FakeMapConstructor;\nsetup(FakeMap);\nFakeMap[Symbol.species] = FakeMap;\nexport default FakeMap;\n","import { s } from \"../constants.js\";\nlet entries: () => IterableIterator<[any, any]>,\n  values: () => IterableIterator<any>,\n  keys: () => IterableIterator<any>;\ntype FakeSet = import(\"./index\").default<any>;\nif (typeof Symbol !== \"undefined\") {\n  entries = function entries(this: FakeSet): IterableIterator<any> {\n    return setKeyValIterator(this, true);\n  };\n  function setKeyValIterator(set: FakeSet, isDup: boolean) {\n    const _ = set[s];\n    let i = 0;\n    const len = _.length;\n    const obj: IterableIterator<any> = {\n      [Symbol.iterator]: function() {\n        return this;\n      },\n      next: function() {\n        if (i < len) {\n          const v = _[i++];\n          return { value: isDup ? [v, v] : v, done: false };\n        }\n        return { value: void 0, done: true };\n      }\n    };\n    return obj;\n  }\n  values = function values(this: FakeSet) {\n    return setKeyValIterator(this, false);\n  };\n  keys = function keys(this: FakeSet) {\n    return setKeyValIterator(this, false);\n  };\n} else {\n  entries = keys = values = function() {\n    console.warn(\"no symbol support\");\n  } as never;\n}\nexport default { keys, values, entries };\n","import { HAS_SET, s } from \"../constants.js\";\nimport setup from \"./proto.js\";\nimport { isIterable } from \"../../../util.js\";\nimport { _classCallCheck } from \"../../../../shared.js\";\nfunction generateSet(fs: FakeSet<any>, it: Iterable<any> | undefined) {\n  if (it == null) return;\n  if (!isIterable(it))\n    throw new Error(\"value:\" + String(it) + \" is not iterable\");\n  const len = (it as Array<any>).length;\n  for (let i = 0; i < len; i++) {\n    const k = (it as Array<any>)[i];\n    fs.add(k);\n  }\n}\ninterface FakeSet<T> {\n  add(value: T): this;\n  clear(): void;\n  delete(value: T): boolean;\n  forEach(\n    callbackfn: (value: T, value2: T, set: FakeSet<T>) => void,\n    thisArg?: any\n  ): void;\n  has(value: T): boolean;\n  readonly size: number;\n  [s]: Array<T>;\n  [Symbol.toStringTag]: string;\n  [Symbol.iterator](): IterableIterator<T>;\n  entries(): IterableIterator<[T, T]>;\n  keys(): IterableIterator<T>;\n  values(): IterableIterator<T>;\n}\n\nexport interface FakeSetConstructor {\n  new <T = any>(values?: ReadonlyArray<T> | null): FakeSet<T>;\n  readonly prototype: FakeSet<any>;\n  [Symbol.species]: FakeSetConstructor;\n}\n\nconst FakeSet = (function FakeSet<T>(\n  this: FakeSet<T>,\n  iterable?: Iterable<T>,\n  forceUseCustomImplementation?: boolean\n) {\n  _classCallCheck(this, FakeSet);\n  if (!forceUseCustomImplementation && HAS_SET) return new Set(iterable);\n  this[s] = [];\n  generateSet(this, iterable);\n} as any) as FakeSetConstructor;\nsetup(FakeSet);\nFakeSet[Symbol.species] = FakeSet;\nexport default FakeSet;\n","import { s, _EqCheck as is, normalizeNegativeZero } from \"../constants.js\";\nimport symbolProps from \"./_Symbol.js\";\nimport assign from \"../../../Object/assign.js\";\n\nexport default function setPrototypeProps(\n  FakeSet: import(\"./index\").FakeSetConstructor\n) {\n  FakeSet.prototype.add = function set(k) {\n    if (!this.has(k)) this[s].push(normalizeNegativeZero(k));\n    return this;\n  };\n  FakeSet.prototype.has = function has(key) {\n    const arr = this[s];\n    const len = arr.length;\n    for (let i = 0; i < len; i++) {\n      const x = arr[i];\n      if (is(x, key)) return true;\n    }\n    return false;\n  };\n  FakeSet.prototype.delete = function del(k) {\n    let had: boolean = false;\n    this[s] = this[s].filter(x => {\n      const c = !is(x, k);\n      if (!c) had = true;\n      return c;\n    });\n    return had;\n  };\n  FakeSet.prototype.forEach = function forEach(cb, that) {\n    const arr = this[s];\n    const len = arr.length;\n    for (let i = 0; i < len; i++) {\n      const val = arr[i];\n      const a = val,\n        c = this;\n      that ? cb.call(that, a, a, c) : cb(a, a, c);\n    }\n  };\n\n  FakeSet.prototype.clear = function clear() {\n    return void (this[s].length = 0);\n  };\n  Object.defineProperty(FakeSet.prototype, \"size\", {\n    enumerable: false,\n    configurable: true,\n    get: function() {\n      return this[s].length;\n    }\n  });\n  if (typeof Symbol !== \"undefined\") {\n    FakeSet.prototype[Symbol.iterator] = symbolProps.values;\n    FakeSet.prototype[Symbol.toStringTag] = \"Set\";\n  }\n  assign(FakeSet.prototype, symbolProps);\n}\n","import { has, patchGlobalThis } from \"../../util.js\";\nimport keys from \"../../Object/keys.js\";\nconst e = {};\nconst gl = patchGlobalThis();\nexport function _getCryptoOrMathRandom(): string {\n  const hasCrypto = has(\"crypto\", gl);\n  let rv;\n  if (hasCrypto) {\n    rv = gl.crypto.getRandomValues;\n    if (rv) {\n      rv = rv.bind(crypto);\n      return rv(new Uint8Array(10)).join(\"-\");\n    }\n  }\n  return String(Math.random());\n}\n\nexport function initializeInternalKeyProp(obj: object, key: string): void {\n  if (key in obj) return;\n  Object.defineProperty(obj, key, { value: {}, enumerable: false });\n}\nexport type sealableMethod = \"freeze\" | \"seal\" | \"preventExtensions\";\nexport function _patchObjectSealingMethods(key: string) {\n  function _patch(m: sealableMethod) {\n    const method = Object[m];\n    if ((method as any).__patched === e) return;\n    let fn: <T>(obj: T[]) => <T>(obj: T[]) => any;\n    fn = (Object[m] as any) = function FakeMethod<T>(obj: T[]) {\n      initializeInternalKeyProp(obj, key);\n      return (method as typeof fn)(obj);\n    };\n    (fn as any).__patched = e;\n  }\n  [\"freeze\", \"seal\", \"preventExtensions\"].forEach(i =>\n    _patch(i as sealableMethod)\n  );\n}\n\nexport function isObjectOrThrow(i: object): void {\n  if (Object(i) !== i) {\n    throw new Error(\"Invalid value\");\n  }\n}\n\nexport function _patchPropertyDescriptorMethods(key: string) {\n  if (has(\"getOwnPropertyDescriptors\", Object)) {\n    const oldOPD = Object.getOwnPropertyDescriptors;\n    Object.getOwnPropertyDescriptors = function<T>(\n      o: T\n    ): { [P in keyof T]: TypedPropertyDescriptor<T[P]> } & {\n      [x: string]: PropertyDescriptor;\n    } {\n      const prevDescriptors = oldOPD(o);\n      const ret = {} as typeof prevDescriptors;\n      keys(prevDescriptors).forEach(x => {\n        if (x !== key) (ret as any)[x] = prevDescriptors[x];\n      });\n      return ret;\n    };\n  }\n  if (has(\"getOwnPropertyNames\", Object)) {\n    const oldOPN = Object.getOwnPropertyNames;\n    Object.getOwnPropertyNames = function(o: any): string[] {\n      return oldOPN(o).filter(x => x !== key);\n    };\n  }\n}\n","import { HAS_WEAK } from \"../constants.js\";\nimport { isIterable } from \"../../../util.js\";\nimport {\n  _getCryptoOrMathRandom,\n  initializeInternalKeyProp,\n  _patchObjectSealingMethods,\n  isObjectOrThrow,\n  _patchPropertyDescriptorMethods\n} from \"../Weak-shared.js\";\nimport { _classCallCheck } from \"../../../../shared.js\";\nconst __WEAK__KEY =\n  \"@@WeakMap__\" +\n  +new Date() +\n  Math.random().toString(16) +\n  \"-\" +\n  _getCryptoOrMathRandom();\ninterface patchedObj {\n  [key: string]: {\n    [id: number]: Array<any>;\n  };\n}\nexport const patchObjectSealingMethods = _patchObjectSealingMethods.bind(\n  void 0,\n  __WEAK__KEY\n);\nexport const patchPropertyDescriptorMethods = _patchPropertyDescriptorMethods.bind(\n  void 0,\n  __WEAK__KEY\n);\nfunction generateMap(fm: FakeWeakMap<any, any>, it: Iterable<any> | undefined) {\n  if (it == null) return;\n  if (!isIterable(it))\n    throw new Error(\"value:\" + String(it) + \" is not iterable\");\n  const len = (it as Array<any>).length;\n  for (let i = 0; i < len; i++) {\n    const k = (it as Array<any>)[i];\n    if (!k || k.length !== 2) throw new Error(\"invalid arg\");\n    fm.set(k[0], k[1]);\n  }\n}\ninterface FakeWeakMap<K extends object, V> {\n  delete(key: K): boolean;\n  get(key: K): V | undefined;\n  has(key: K): boolean;\n  set(key: K, value: V): this;\n  [Symbol.toStringTag]: string;\n  _id: number;\n}\ninterface FakeWeakMapConstructor {\n  new <K extends object = object, V = any>(\n    entries?: ReadonlyArray<[K, V]> | null,\n    forceUseCustomImplementation?: boolean\n  ): FakeWeakMap<K, V>;\n  [Symbol.species]: FakeWeakMapConstructor;\n  prototype: FakeWeakMap<object, any>;\n}\nlet weakMapIds = 0;\n/**\n * this implementation holds the value in the key itself instead of holding the key as\n * a reference.\n * however, we need to patch Object.{freeze,seal,preventExtensions}\n * or WeakMaps on previously frozen objects would not work\n *\n */\nconst FakeWeakMap = (function FakeWeakMap<K extends object, V>(\n  this: FakeWeakMap<K, V>,\n  iterable: Iterable<[K, V]>,\n  forceUseCustomImplementation?: boolean\n) {\n  if (!forceUseCustomImplementation && HAS_WEAK) return new WeakMap(iterable);\n  _classCallCheck(this, FakeWeakMap);\n  patchObjectSealingMethods();\n  patchPropertyDescriptorMethods();\n  this._id = ++weakMapIds;\n  generateMap(this, iterable);\n} as any) as FakeWeakMapConstructor;\nfunction _getKeyValArr<K extends patchedObj>(key: K, id: number) {\n  const c = key[__WEAK__KEY];\n  return c ? c[id] : void 0;\n}\nFakeWeakMap[Symbol.species] = FakeWeakMap;\nfunction initSafeSetup<K extends patchedObj>(key: K) {\n  isObjectOrThrow(key);\n  initializeInternalKeyProp(key, __WEAK__KEY);\n}\nFakeWeakMap.prototype = {\n  [Symbol.toStringTag]: \"WeakMap\",\n  _id: 0,\n  delete<K extends patchedObj>(key: K): boolean {\n    initSafeSetup(key);\n    const prevArr = _getKeyValArr(key, this._id);\n    if (!prevArr) return false;\n    delete key[__WEAK__KEY][this._id];\n    return true;\n  },\n  set<K extends patchedObj, V>(key: K, val: V): FakeWeakMap<K, V> {\n    initSafeSetup(key);\n    const prevArr = _getKeyValArr(key, this._id);\n    if (prevArr && prevArr[0] === this._id) {\n      prevArr[1] = val;\n    } else {\n      key[__WEAK__KEY][this._id] = [this._id, val];\n    }\n    return this;\n  },\n  has<K extends patchedObj>(key: K): boolean {\n    initSafeSetup(key);\n    return !!_getKeyValArr(key, this._id);\n  },\n  get<K extends patchedObj>(key: K): any | undefined {\n    initSafeSetup(key);\n    const val = _getKeyValArr(key, this._id);\n    if (val && val[0] === this._id) {\n      return val[1];\n    }\n  }\n};\n\nexport default FakeWeakMap;\n","import _WeakMap from \"../WeakMap/index.js\";\nimport { HAS_WEAK } from \"../constants.js\";\nimport { _classCallCheck } from \"../../../../shared.js\";\nimport { isIterable } from \"../../../util.js\";\n\nfunction generateSet(fs: FakeWeakSet<any>, it: Iterable<any> | undefined) {\n  if (it == null || !fs.__map) return;\n  if (!isIterable(it))\n    throw new Error(\"value:\" + String(it) + \" is not iterable\");\n  const len = (it as Array<any>).length;\n  for (let i = 0; i < len; i++) {\n    const k = (it as Array<any>)[i];\n    fs.__map.set(k, k);\n  }\n}\n\ninterface FakeWeakSet<T extends object> {\n  add(value: T): this;\n  delete(value: T): boolean;\n  has(value: T): boolean;\n  __map?: _WeakMap<T, T>;\n  readonly [Symbol.toStringTag]: string;\n}\n\ninterface FakeWeakSetConstructor {\n  new <T extends object = object>(\n    values?: ReadonlyArray<T> | null\n  ): FakeWeakSet<T>;\n  [Symbol.species]: FakeWeakSetConstructor;\n  prototype: FakeWeakSet<object>;\n}\n/**\n * weak set - either use native or use a weakmap (native or pollyfilled..doesnt matter)\n *\n * @returns {WeakSet}\n * @param {Iterable} iterable\n * @param {boolean} forceUseCustomImplementations\n */\nconst FakeWeakSet = (function FakeWeakSet<T extends object>(\n  this: FakeWeakSet<T>,\n  iterable: Iterable<T>,\n  forceUseCustomImplementations?: boolean\n) {\n  _classCallCheck(this, FakeWeakSet);\n  if (!forceUseCustomImplementations && HAS_WEAK) return new WeakSet(iterable);\n  this.__map = new _WeakMap(null, forceUseCustomImplementations);\n  generateSet(this, iterable);\n} as any) as FakeWeakSetConstructor;\n\nFakeWeakSet[Symbol.species] = FakeWeakSet;\nFakeWeakSet.prototype = {\n  [Symbol.toStringTag]: \"WeakSet\",\n  add<T extends object>(k: T): FakeWeakSet<T> {\n    if (!this.__map) throw new Error(\"Invalid Initialization\");\n    if (this.__map.has(k)) return this as FakeWeakSet<T>;\n    this.__map.set(k, k);\n    return this as FakeWeakSet<T>;\n  },\n  has(k) {\n    if (!this.__map) throw new Error(\"Invalid Initialization\");\n    return this.__map.has(k);\n  },\n  delete(k) {\n    if (!this.__map) throw new Error(\"Invalid Initialization\");\n    return this.__map.delete(k);\n  }\n};\n\nexport default FakeWeakSet;\n","import Object_keys from \"./keys.js\";\nimport { _Object } from \"../util.js\";\nexport default \"entries\" in _Object\n  ? _Object.entries\n  : (function Object_entries(a: { [key: string]: any }) {\n      const keys = Object_keys(a);\n      let kLen = keys.length;\n      const ret = Array(kLen);\n      while (kLen--) {\n        const p = keys[kLen];\n        ret[kLen] = [p, a[p]];\n      }\n      return ret;\n    } as ObjectConstructor[\"entries\"]);\n","import keys from \"./keys.js\";\nimport { _Object } from \"../util.js\";\nexport default \"values\" in _Object\n  ? _Object.values\n  : (function Object_values(a: import(\"./ot\").default) {\n      const arr: Array<any> = [];\n      const keyArr = keys(a);\n      keyArr.forEach(i => arr.push(a[i]));\n      return arr;\n    } as ObjectConstructor[\"values\"]);\n","import { _Object } from \"../util.js\";\n\nexport default \"fromEntries\" in _Object\n  ? _Object.fromEntries\n  : (function Object_fromEntries(entries: import(\"./ot\").default) {\n      const ret: import(\"./ot\").default = {};\n      entries.forEach((k: Array<any>) => (ret[k[0]] = k[1]));\n      return ret;\n    } as ObjectConstructor[\"fromEntries\"]);\n","import { _Object } from \"../util.js\";\nexport default \"is\" in _Object\n  ? _Object.is\n  : (function is(x: any, y: any): boolean {\n      if (x === y) {\n        return x !== 0 || 1 / x === 1 / y;\n      } else {\n        return x !== x && y !== y;\n      }\n    } as ObjectConstructor[\"is\"]);\n","import { browserOnlyWarning } from \"../warnings.js\";\nimport { _generateDocFrag, emptyArr, has } from \"../util.js\";\nexport default function Element_after(element: Element) {\n  if (!element) throw new Error(\"Cannot add elements to null\");\n  browserOnlyWarning._throw();\n  const args = emptyArr.slice.call(arguments, 1);\n  if (has(\"after\", element)) {\n    return element.after.apply(element, args);\n  }\n  const frag = _generateDocFrag(args);\n  const parent = element.parentNode;\n  if (parent == null) throw new Error(\"Cannot append elements after orphan\");\n  parent.insertBefore(frag, element.nextSibling);\n}\n","import { browserOnlyWarning } from \"../warnings.js\";\nimport { _generateDocFrag, emptyArr, has } from \"../util.js\";\nexport default function Element_prepend(element: Element) {\n  browserOnlyWarning._throw();\n  if (!element) throw new Error(\"cannot prepend elements\");\n  const args = emptyArr.slice.call(arguments, 1);\n  if (has(\"prepend\", element)) {\n    return element.prepend.apply(element, args);\n  }\n  const frag = _generateDocFrag(args);\n  element.insertBefore(frag, element.firstChild);\n}\n","type anyFunc = (a: any) => any;\ntype anyAsyncFunc = (a: any) => Promise<any>;\ninterface PipeInterface {\n  readonly _buffer: Array<anyFunc>;\n  readonly _batch: boolean;\n  _value: any;\n  readonly reusable: boolean;\n}\nfunction _clone<T>(arr: Array<T>): Array<T> {\n  const len = arr.length;\n  const ret: Array<T> = Array(len);\n  for (let i = 0; i < len; i++) {\n    ret[i] = arr[i];\n  }\n  return ret;\n}\nexport class Pipe implements PipeInterface {\n  readonly _buffer: Array<anyFunc>;\n  _value: any;\n  constructor(\n    func: anyFunc,\n    readonly _batch: boolean,\n    public readonly reusable: boolean\n  ) {\n    this._buffer = [func];\n    this._value = null;\n  }\n  _commitBuffers() {\n    let fn;\n    const buf = this.reusable ? _clone(this._buffer) : this._buffer;\n    while ((fn = buf.shift())) {\n      this._value = fn(this._value);\n    }\n  }\n  through(nextFunc: anyFunc) {\n    this._buffer.push(nextFunc);\n    return this;\n  }\n  get(arg: any) {\n    this._value = arg;\n    if (!this._batch) this._commitBuffers();\n    return this;\n  }\n  value() {\n    if (this._batch) this._commitBuffers();\n    return this._value;\n  }\n}\n\nexport class AsyncPipe extends Pipe {\n  _buffer: Array<anyAsyncFunc>;\n  constructor(func: anyAsyncFunc, public readonly reusable: boolean) {\n    super(func, true, reusable);\n    this._buffer = [func];\n  }\n  async _commitBuffers() {\n    let fn: anyAsyncFunc;\n    const buf = this.reusable ? _clone(this._buffer) : this._buffer;\n    while ((fn = buf.shift() as anyAsyncFunc)) {\n      this._value = await fn(this._value);\n    }\n  }\n  async value() {\n    await this._commitBuffers();\n    return this._value;\n  }\n}\n","import FakeMap from \"../es6/loose/Map/index\";\n\ninterface CacheOptions {\n  isAsync?: boolean;\n  resolver?(...a: unknown[]): string | number | symbol;\n}\nconst defaultOptions: CacheOptions = {\n  isAsync: false,\n  resolver(args: Array<unknown>) {\n    return String(args[0]);\n  },\n};\n\ninterface UnknownFunction<T> {\n  (...a: unknown[]): T;\n}\n\nexport function cache<T>(\n  func: UnknownFunction<T | Promise<T>>,\n  options?: CacheOptions\n): UnknownFunction<T | Promise<T>> {\n  options = options || {};\n  const resolver = options.resolver || defaultOptions.resolver;\n  const cachedResults = new FakeMap<string | number | symbol, T>();\n\n  const isAsync = options.isAsync || defaultOptions.isAsync;\n\n  function cached(...a: unknown[]): T | Promise<T>;\n  function cached(): T | Promise<T> {\n    const argsArray = [].slice.call(arguments);\n    const key = (resolver as any)(argsArray);\n\n    const ret = cachedResults.get(key);\n    if (ret) return ret;\n\n    const result = func.apply(null, argsArray);\n    if (!isAsync) {\n      cachedResults.set(key, result as T);\n      return result;\n    }\n    return (result as Promise<T>).then((value) => {\n      cachedResults.set(key, value as T);\n      return value;\n    });\n  }\n  cached._Map = cachedResults;\n  return cached;\n}\n","export function debounce<T>(time: number, fn: (...a: unknown[]) => T) {\n  let timer: ReturnType<typeof setTimeout>;\n  return function (this: unknown) {\n    const context = this;\n    clearTimeout(timer);\n    timer = setTimeout(\n      () => fn.apply(context, (arguments as unknown) as unknown[]),\n      time || 400\n    );\n  };\n}\n"],"names":["patchGlobalThis","globalThis","Object","defineProperty","prototype","get","configurable","___this","r","global","_Sym","Symbol","has","a","b","emptyObj","emptyArr","isIterable","k","iterator","_Object","constructor","hasOwnProp","hasOwnProperty","_generateDocFrag","args","frag","document","createDocumentFragment","forEach","arg","appendChild","Node","createTextNode","String","domContext","window","navigator","userAgent","createElement","workerContext","self","postMessage","importScripts","isBrowser","browserOnlyWarning","warn","msg","console","_throw","Error","base64ToArrayBuffer","b64","fetch","then","x","arrayBuffer","nextEvent","obj","event","Promise","res","addEventListener","once","arrayBufferToBase64","buffer","resolve","_","blob","Blob","type","reader","FileReader","onload","evt","target","dataurl","result","substr","indexOf","readAsDataURL","wait","m","setTimeout","retry","fn","max","waitInMS","bind","tries","apply","slice","call","arguments","e","name","keys","arr","i","push","urlencode","URLSearchParams","toString","map","encodeURIComponent","join","assign","length","source","key","Element_append","element","append","loadCSS","url","link","rel","href","rej","opt","head","_global","patch","HAS_MAP","HAS_SET","HAS_WEAK","s","_isNaN","_EqCheck","y","normalizeNegativeZero","entries","values","mapKeyValIterator","isKey","len","kv","[object Object]","next","value","done","this","__i_getMapArr","that","is","_classCallCheck","instance","Constructor","left","right","hasInstance","TypeError","FakeMap","iterable","forceUseCustomImplementation","Map","fm","it","set","generateMap","v","prevArr","delete","had","filter","c","undefined","cb","val","clear","enumerable","symbolProps","toStringTag","setup","species","setKeyValIterator","isDup","FakeSet","Set","fs","add","generateSet","gl","initializeInternalKeyProp","__WEAK__KEY","Date","Math","random","rv","crypto","getRandomValues","Uint8Array","_getCryptoOrMathRandom","patchObjectSealingMethods","method","__patched","_patch","patchPropertyDescriptorMethods","oldOPD","getOwnPropertyDescriptors","o","prevDescriptors","ret","oldOPN","getOwnPropertyNames","weakMapIds","FakeWeakMap","WeakMap","_id","_getKeyValArr","id","initSafeSetup","isObjectOrThrow","FakeWeakSet","forceUseCustomImplementations","WeakSet","__map","_WeakMap","Object_keys","kLen","Array","p","fromEntries","Element_after","after","parent","parentNode","insertBefore","nextSibling","Element_prepend","prepend","firstChild","_clone","Pipe","func","_batch","reusable","_buffer","_value","_commitBuffers","buf","shift","through","nextFunc","AsyncPipe","super","defaultOptions","isAsync","resolver","cache","options","cachedResults","cached","argsArray","_Map","debounce","time","timer","context","clearTimeout"],"mappings":"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"}